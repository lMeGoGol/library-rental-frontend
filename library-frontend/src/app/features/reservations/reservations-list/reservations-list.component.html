<section class="card">
  <div class="section-title">üîî –ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</div>
  <div class="toolbar">
    <label>–°—Ç–∞—Ç—É—Å:</label>
    <select (change)="setStatus(($any($event.target)).value)">
      <option value="pending" [selected]="status==='pending'">–û—á—ñ–∫—É—î</option>
      <option value="fulfilled" [selected]="status==='fulfilled'">–í–∏–¥–∞–Ω–æ</option>
      <option value="cancelled" [selected]="status==='cancelled'">–°–∫–∞—Å–æ–≤–∞–Ω–æ</option>
    </select>
  </div>

  <div *ngIf="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶</div>
  <div *ngIf="!loading && error" class="error">{{ error }}</div>
  <div *ngIf="!loading && !reservations.length" class="card empty">–ù–µ–º–∞—î –±—Ä–æ–Ω—ñ</div>

  <table *ngIf="!loading && reservations.length" class="lib-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>–ö–Ω–∏–≥–∞</th>
  <th>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</th>
  <th *ngIf="status==='cancelled'">–ü—Ä–∏—á–∏–Ω–∞</th>
        <th>–î–Ω—ñ</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–î—ñ—ó</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of reservations; trackBy: trackById">
        <td class="mono">{{ r.id }}</td>
  <td>{{ (typeof r.book==='string' ? r.book : r.book.title) || '-' }}</td>
  <td>
    <a *ngIf="isObj(r.reader)" [routerLink]="['/users', getId(r.reader), 'profile']" class="user-link">{{ getUsername(r.reader) }}</a>
    <span *ngIf="!isObj(r.reader)">{{ r.reader || '-' }}</span>
  </td>
  <td *ngIf="status==='cancelled'">{{ r.cancelReason || '‚Äî' }}</td>
        <td>{{ r.desiredDays }}</td>
  <td>{{ r.status==='pending' ? '–æ—á—ñ–∫—É—î' : (r.status==='fulfilled' ? '–≤–∏–∫–æ–Ω–∞–Ω–æ' : '—Å–∫–∞—Å–æ–≤–∞–Ω–æ') }}</td>
        <td class="row-actions">
          <button class="btn" (click)="issue(r)" [disabled]="r.status!=='pending'">–í–∏–¥–∞—Ç–∏</button>
          <button class="btn outline" (click)="cancel(r)" [disabled]="r.status!=='pending'">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </td>
      </tr>
    </tbody>
  </table>

  <app-pager [page]="page" [limit]="limit" [total]="total" [pages]="pages" (prev)="prev()" (next)="next()" />
</section>
